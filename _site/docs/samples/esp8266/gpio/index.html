

<!Doctype html>
<html id="docs" class="Samples">



<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	
	<!-- Begin Jekyll SEO tag v2.0.0 -->
<title>ESP8266 GPIO control over MQTT using Thingsboard - Thingsboard</title>
<meta property="og:title" content="ESP8266 GPIO control over MQTT using Thingsboard" />
<meta name="description" content="Thingsboard IoT Platform sample for ESP8266 GPIO control over MQTT" />
<meta property="og:description" content="Thingsboard IoT Platform sample for ESP8266 GPIO control over MQTT" />
<link rel="canonical" href="http://localhost:4000/docs/samples/esp8266/gpio/" />
<meta property="og:url" content="http://localhost:4000/docs/samples/esp8266/gpio/" />
<meta property="og:site_name" content="Thingsboard" />
<meta property="og:image" content="http://localhost:4000/images/thingsboard_logo.png" />
<meta name="twitter:image" content="http://localhost:4000/images/thingsboard_logo.png" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:site" content="@thingsboard" />
<meta name="twitter:creator" content="@thingsboard" />
<script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "WebPage",
    "headline": "ESP8266 GPIO control over MQTT using Thingsboard",
    "image": "http://localhost:4000/images/thingsboard_logo.png",
    "description": "Thingsboard IoT Platform sample for ESP8266 GPIO control over MQTT",
    "logo": "http://localhost:4000/images/thingsboard_logo.png",
    "url": "http://localhost:4000/docs/samples/esp8266/gpio/"
  }
</script>
<!-- End Jekyll SEO tag -->
	
	
	<meta name="twitter:description" content="Thingsboard IoT Platform sample for ESP8266 GPIO control over MQTT"/>
	
	
	<link rel="shortcut icon" type="image/png" href="/images/favicon.png">
	<link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700" rel="stylesheet">
	<link rel="stylesheet" href="/css/styles.css">
	<script type="text/javascript">
		/*! loadCSS. [c]2017 Filament Group, Inc. MIT License */
		!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);
		/*! onloadCSS. (onload callback for loadCSS) [c]2017 Filament Group, Inc. MIT License */
		function onloadCSS(a,b){function c(){!d&&b&&(d=!0,b.call(a))}var d;a.addEventListener&&a.addEventListener("load",c),a.attachEvent&&a.attachEvent("onload",c),"isApplicationInstalled"in navigator&&"onloadcssdefined"in a&&a.onloadcssdefined(c)}
	</script>
	<script type="text/javascript">

		function jqueryDefer(method) {
			if (window.jQuery) {
				method();
			} else {
				setTimeout(function() {
					jqueryDefer(method)
				}, 50);
			}
		}

		function jqueryUiDefer(method) {
			if (window.jQuery && window.jQuery.ui) {
				method();
			} else {
				setTimeout(function() {
					jqueryUiDefer(method)
				}, 50);
			}
		}

		function loadScript(src, callback)
		{
			var s, r, t;
			r = false;
			s = document.createElement('script');
			s.type = 'text/javascript';
			s.src = src;
			s.onload = s.onreadystatechange = function() {
				if ( !r && (!this.readyState || this.readyState == 'complete') )
				{
					r = true;
					if (callback) {
						callback();
					}
				}
			};
			t = document.getElementsByTagName('script')[0];
			t.parentNode.insertBefore(s, t);
		}

		function loadCssAsync(src, callback) {
			var stylesheet = loadCSS( src );
			if (callback) {
				onloadCSS(stylesheet, callback);
			}
		}

		function loadNextScript(index, scriptsList, completeCallback) {
			if (index < scriptsList.length) {
				var script = scriptsList[index];
				if (script.type === 'script') {
					loadScript(script.src, function() {
						index++;
						loadNextScript(index, scriptsList, completeCallback);
					});
				} else if (script.type === 'css') {
					loadCssAsync(script.src, function() {
						index++;
						loadNextScript(index, scriptsList, completeCallback);
					});
				}
			} else if (completeCallback) {
				completeCallback();
			}
		}

		var initialScriptsList = [
			{src: '/js/jquery-2.2.0.min.js', type: 'script'},
			{src: '/css/jquery-ui.min.css', type: 'css'},
			{src: '/js/jquery-ui.min.js', type: 'script'},
			{src: '/js/script.js', type: 'script'},
			{src: '/css/sweetalert.css', type: 'css'},
			{src: '/js/sweetalert.min.js', type: 'script'}
		];

		loadNextScript(0, initialScriptsList);

	</script>
	<script type="text/javascript">
		function _gaLt(event) {
			/* If GA is blocked or not loaded, or not main|middle|touch click then don't track */
			if (!ga.hasOwnProperty("loaded") || ga.loaded != true || (event.which != 1 && event.which != 2)) {
				return;
			}
			var el = event.srcElement || event.target;

			while (el && (typeof el.tagName == 'undefined' || el.tagName.toLowerCase() != 'a' || !el.href)) {
				el = el.parentNode;
			}
			if (el && el.href) {
				var link = el.href;
				if ((link.indexOf(location.host) == -1 || link.indexOf('.' + location.host) > 0) && !link.match(/^javascript\:/i)) {
					var target = (el.target && !el.target.match(/^_(self|parent|top)$/i)) ? el.target : false;
					if (event.ctrlKey || event.shiftKey || event.metaKey || event.which == 2) {
						target = "_blank";
					}

					var hbrun = false; // tracker has not yet run
					var hitBack = function() {
						if (hbrun) return;
						hbrun = true;
						window.location.href = link;
					};

					if (target) {
						ga(
								"send", "event", "Outgoing Links", link,
								document.location.pathname + document.location.search
						);
					} else {
						event.preventDefault ? event.preventDefault() : event.returnValue = !1;
						ga(
								"send", "event", "Outgoing Links", link,
								document.location.pathname + document.location.search, {
									"hitCallback": hitBack
								}
						);

						setTimeout(hitBack, 1000);
					}
				}
			}
		}

		var _w = window;
		var _gaLtEvt = ("ontouchstart" in _w) ? "click" : "mousedown";
		_w.addEventListener ? _w.addEventListener("load", function() {document.body.addEventListener(_gaLtEvt, _gaLt, !1)}, !1)
				: _w.attachEvent && _w.attachEvent("onload", function() {document.body.attachEvent("on" + _gaLtEvt, _gaLt)});
	</script>
	<script>
		(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
					(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
				m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

		ga('create', 'UA-88383331-1', 'auto');
		ga('send', 'pageview');
	</script>
</head>
<body>
<div id="cellophane" onclick="tb.toggleMenu()"></div>
<header>
	<a href="/" class="logo"></a>
	<div id="githubButtonContainer">
		<iframe id="gh-btn-frame" src="https://ghbtns.com/github-btn.html?user=thingsboard&repo=thingsboard&type=star&count=true&size=large"
				frameborder="0"
				scrolling="0" width="130px" height="30px"></iframe>
	</div>
	<div class="nav-buttons" data-auto-burger="primary">
		<a href="/docs/" class="button" id="viewDocs" data-auto-burger-exclude>View Documentation</a>
		<a href="/iot-use-cases/" class="button" id="useCases" data-auto-burger-exclude>Use cases</a>
		<a href="/docs/getting-started-guides/helloworld/" class="button" id="gettingStarted" data-auto-burger-exclude>Getting started</a>
		<a target="_blank" href="https://demo.thingsboard.io/signup" class="button" id="liveDemo" data-auto-burger-exclude>Live demo</a>
		<button id="hamburger" onclick="tb.toggleMenu()" data-auto-burger-exclude><div></div></button>
	</div>

	<nav id="mainNav">
		<main id="headNav" data-auto-burger="primary">
			<div class="nav-box">
				<h3><a href="/docs/getting-started-guides/helloworld/">Get Started</a></h3>
			</div>
			<div class="nav-box">
				<h3><a href="/docs/">Documentation</a></h3>
			</div>
			<div class="nav-box">
				<h3><a href="/iot-use-cases/">Use cases</a></h3>
			</div>
			<div class="nav-box">
				<h3><a href="http://blog.thingsboard.io/">Blog</a></h3>
			</div>
			<div class="nav-box">
				<h3><a href="/docs/services/">Services</a></h3>
			</div>
			<div class="nav-box">
				<h3><a href="/docs/contact-us/">Contact us</a></h3>
			</div>
		</main>
		<main data-auto-burger="primary">
			<div class="center">
				<div class="social">
					<a href="https://twitter.com/thingsboard" class="twitter"><span>Twitter</span></a>
					<a href="https://github.com/thingsboard/thingsboard" class="github"><span>Github</span></a>
					<a href="https://gitter.im/thingsboard/chat" class="gitter"><span>Gitter</span></a>
					<a href="http://stackoverflow.com/questions/tagged/thingsboard" class="stack-overflow"><span>Stack Overflow</span></a>
					<a href="https://groups.google.com/forum/#!forum/thingsboard" class="mailing-list"><span>Mailing List</span></a>
					<a href="https://www.youtube.com/channel/UCDb9fsV-YR4JmnipAMGsVAQ" class="youtube"><span>YouTube Channel</span></a>
					<a href="https://www.facebook.com/thingsboard" class="facebook"><span>Facebook Page</span></a>
				</div>
			</div>
			<div class="clear" style="clear: both"></div>
		</main>
	</nav>
</header>


<!--  HERO  -->
<section id="hero" class="light-text">
  <h1>Samples</h1>
  <h5>A collection of example applications that show how to use Thingsboard.</h5>
  <div id="vendorStrip" class="light-text">
    <div id="docsList">
        <ul>
          <li><a href="/docs/" >DOCS HOME</a></li>
          <li><a href="/docs/api/" >API</a></li>
          <li><a href="/docs/iot-gateway/" >IOT GATEWAY</a></li>
          <li><a href="/docs/reference/" >REFERENCE</a></li>
          <li><a href="/docs/samples/" class="YAH">SAMPLES</a></li>
          <li><a href="/iot-use-cases/" >USE CASES</a></li>
          <li><a href="/docs/iot-video-tutorials/" >VIDEO TUTORIALS</a></li>
          <li><a href="/docs/faq/" >FAQ</a></li>
          <li><a href="/docs/services/" >SERVICES</a></li>
          <li><a href="/docs/contact-us/" >CONTACT US</a></li>
        </ul>
    </div>
    <div id="searchBox">
      <input type="text" id="search" placeholder="Search" onkeydown="if (event.keyCode==13) window.location.replace('/docs/search/?q=' + this.value)">
    </div>
  </div>
</section>





<section id="encyclopedia">
  
  <div id="docsToc" >
        <div class="pi-accordion">
        
    <a class="item" data-title="Samples" href="/docs/samples/"></a>
    <a class="item" data-title="Live Demo Server" href="/docs/user-guide/live-demo/"></a>
    <a class="item" data-title="Local Demo Account" href="/docs/samples/demo-account/"></a>
<div class="item" data-title="Hardware samples">
  <div class="container">
<div class="item" data-title="Arduino">
  <div class="container">
    <a class="item" data-title="Arduino overview" href="/docs/samples/arduino/"></a>
    <a class="item" data-title="Temperature upload over MQTT using Arduino UNO, ESP8266 and DHT22 sensor" href="/docs/samples/arduino/temperature/"></a>
  </div>
</div>
<div class="item" data-title="ESP8266">
  <div class="container">
    <a class="item" data-title="ESP8266 overview" href="/docs/samples/esp8266/"></a>
    <a class="item" data-title="Temperature upload over MQTT using ESP8266 and DHT22 sensor" href="/docs/samples/esp8266/temperature/"></a>
    <a class="item" data-title="ESP8266 GPIO control over MQTT using Thingsboard" href="/docs/samples/esp8266/gpio/"></a>
  </div>
</div>
<div class="item" data-title="NodeMCU">
  <div class="container">
    <a class="item" data-title="NodeMCU overview" href="/docs/samples/nodemcu/"></a>
    <a class="item" data-title="Temperature upload over MQTT using NodeMCU and DHT11 sensor" href="/docs/samples/nodemcu/temperature/"></a>
  </div>
</div>
<div class="item" data-title="Raspberry Pi">
  <div class="container">
    <a class="item" data-title="Raspberry Pi overview" href="/docs/samples/raspberry/"></a>
    <a class="item" data-title="Raspberry Pi GPIO control over MQTT using Thingsboard" href="/docs/samples/raspberry/gpio/"></a>
    <a class="item" data-title="Raspberry Pi GPIO control using Android Things and Thingsboard" href="/docs/samples/raspberry/gpio-android-things/"></a>
    <a class="item" data-title="Temperature upload over MQTT using Raspberry Pi and DHT22 sensor" href="/docs/samples/raspberry/temperature/"></a>
  </div>
</div>
<div class="item" data-title="LinkIt ONE">
  <div class="container">
    <a class="item" data-title="LinkIt ONE overview" href="/docs/samples/linkit-one/"></a>
    <a class="item" data-title="GPS data upload and visualization using LinkIt ONE and Thingsboard" href="/docs/samples/linkit-one/gps/"></a>
  </div>
</div>
  </div>
</div>
<div class="item" data-title="Tutorials">
  <div class="container">
<div class="item" data-title="Alarms">
  <div class="container">
    <a class="item" data-title="Sending Alarms using Email Plugin" href="/docs/samples/alarms/mail/"></a>
    <a class="item" data-title="Alarms based on devices attributes and sensor readings" href="/docs/samples/alarms/basic-rules/"></a>
  </div>
</div>
    <a class="item" data-title="Facilities Monitoring PoC" href="/docs/samples/monitoring/facilities-monitoring-poc/"></a>
  </div>
</div>
        </div> <!-- /pi-accordion -->
    <button class="push-menu-close-button" onclick="tb.toggleToc()"></button>
  </div> <!-- /docsToc -->
  
  <div id="docsContent" class="">
    <h1>ESP8266 GPIO control over MQTT using Thingsboard</h1>
    <ul id="markdown-toc">
  <li><a href="#introduction" id="markdown-toc-introduction">Introduction</a></li>
  <li><a href="#prerequisites" id="markdown-toc-prerequisites">Prerequisites</a></li>
  <li><a href="#list-of-hardware-and-pinouts" id="markdown-toc-list-of-hardware-and-pinouts">List of hardware and pinouts</a></li>
  <li><a href="#wiring-schemes" id="markdown-toc-wiring-schemes">Wiring schemes</a>    <ul>
      <li><a href="#programmingflashing-schema" id="markdown-toc-programmingflashing-schema">Programming/flashing schema</a></li>
      <li><a href="#final-schema-battery-powered" id="markdown-toc-final-schema-battery-powered">Final schema (Battery Powered)</a></li>
    </ul>
  </li>
  <li><a href="#thingsboard-configuration" id="markdown-toc-thingsboard-configuration">Thingsboard configuration</a>    <ul>
      <li><a href="#provision-your-device" id="markdown-toc-provision-your-device">Provision your device</a></li>
      <li><a href="#provision-your-dashboard" id="markdown-toc-provision-your-dashboard">Provision your dashboard</a></li>
    </ul>
  </li>
  <li><a href="#programming-the-esp8266" id="markdown-toc-programming-the-esp8266">Programming the ESP8266</a>    <ul>
      <li><a href="#step-1-esp8266-and-arduino-ide-setup" id="markdown-toc-step-1-esp8266-and-arduino-ide-setup">Step 1. ESP8266 and Arduino IDE setup.</a></li>
      <li><a href="#step-2-install-arduino-libraries" id="markdown-toc-step-2-install-arduino-libraries">Step 2. Install Arduino libraries.</a></li>
      <li><a href="#step-3-prepare-and-upload-sketch" id="markdown-toc-step-3-prepare-and-upload-sketch">Step 3. Prepare and upload sketch.</a></li>
    </ul>
  </li>
  <li><a href="#autonomous-operation" id="markdown-toc-autonomous-operation">Autonomous operation</a></li>
  <li><a href="#troubleshooting" id="markdown-toc-troubleshooting">Troubleshooting</a></li>
  <li><a href="#data-visualization" id="markdown-toc-data-visualization">Data visualization</a></li>
  <li><a href="#next-steps" id="markdown-toc-next-steps">Next steps</a></li>
  <li><a href="#your-feedback" id="markdown-toc-your-feedback">Your feedback</a></li>
</ul>

<h2 id="introduction">Introduction</h2>
<p>Thingsboard is an open-source server-side platform that allows you to monitor and control IoT devices. 
It is free for both personal and commercial usage and you can deploy it anywhere. 
If this is your first experience with the platform we recommend to review 
<a href="/docs/getting-started-guides/what-is-thingsboard/">what-is-thingsboard</a> page and <a href="/docs/getting-started-guides/helloworld/">getting-started</a> guide.</p>

<p>This sample application will allow you to control GPIO of your ESP8266 device using Thingsboard web UI. We will observe GPIO control using Leds connected to the pins. 
The purpose of this application is to demonstrate Thingsboard <a href="/docs/user-guide/rpc/">RPC capabilities</a>.</p>

<p>The application that is running on ESP8266 is written using Arduino SDK which is quite simple and easy to understand.
ESP8266 offers a complete and self-contained Wi-Fi networking solution.
ESP8266 push data to Thingsboard server via MQTT protocol by using <a href="https://github.com/knolleary/pubsubclient">PubSubClient</a> library for Arduino.
Current GPIO state and GPIO control widget is visualized using built-in customizable dashboard.</p>

<p>The video below demonstrates the final result of this tutorial.</p>

<p><br />
<br /></p>
<div id="video">
  <div id="video_wrapper">
    <iframe src="https://www.youtube.com/embed/NGU_MJd7fk8" frameborder="0" allowfullscreen=""></iframe>
  </div>
</div>
<p><br />
<br /></p>

<h2 id="prerequisites">Prerequisites</h2>

<p>You will need to Thingsboard server up and running. Use either <a href="https://demo.thingsboard.io/signup">Live Demo</a> or 
<a href="/docs/user-guide/install/installation-options/">Installation Guide</a> to install Thingsboard.</p>

<h2 id="list-of-hardware-and-pinouts">List of hardware and pinouts</h2>

<ul>
  <li><a href="https://www.aliexpress.com/item/2PCS-ESP8266-Serial-Esp-01-WIFI-Wireless-Transceiver-Module-Send-Receive-LWIP-AP-STA/32302638695.html?spm=2114.03010208.3.163.FPBlcc&amp;ws_ab_test=searchweb0_0,searchweb201602_2_10065_10068_10084_10083_10080_10082_10081_10060_10061_10062_10056_10055_10054_10059_10099_10078_10079_10093_427_10073_10103_10102_10096_10052_10050_10051,searchweb201603_3&amp;btsid=1494d8a7-6202-4a69-a0e7-877ffa333243">ESP8266 module</a></li>
</ul>

<p><img src="/images/samples/arduino/temperature/esp8266-pinout.png" alt="image" /></p>

<ul>
  <li>
    <p>USB to TTL</p>

    <ul>
      <li><a href="https://www.aliexpress.com/item/Free-shipping-1pcs-FT232RL-FTDI-USB-3-3V-5-5V-to-TTL-Serial-Adapter-Module-for/32256920717.html?spm=2114.03010208.3.11.qSXSby&amp;ws_ab_test=searchweb0_0,searchweb201602_2_10065_10068_10084_10083_10080_10082_10081_10060_10061_10062_10056_10055_10054_10059_10099_10078_10079_10093_427_10073_10103_10102_10096_10052_10050_10051,searchweb201603_3&amp;btsid=54ef4b72-5ab0-4ce6-aa89-74726d95c099">With DTR &amp; RTS</a></li>
    </ul>

    <p><img src="/images/samples/esp8266/temperature/usb-ttl-ft232rl-pinout.png" alt="image" /></p>

    <ul>
      <li>Or <a href="https://www.aliexpress.com/item/1pcs-lot-PL2303-USB-To-RS232-TTL-Converter-Adapter-Module-with-Dust-proof-Cover-PL2303HX/32642301991.html?spm=2114.03010208.3.50.WdAM18&amp;ws_ab_test=searchweb0_0,searchweb201602_2_10065_10068_10084_10083_10080_10082_10081_10060_10061_10062_10056_10055_10054_10059_10099_10078_10079_10093_427_10073_10103_10102_10096_10052_10050_10051,searchweb201603_3&amp;btsid=9ac20e48-da8c-4a0f-8f33-d40c241fe5a3">Without DTR &amp; RTS</a></li>
    </ul>

    <p><img src="/images/samples/esp8266/temperature/usb-ttl-pl2303hx.png" alt="image" /></p>
  </li>
  <li>
    <p>Breadboard</p>
  </li>
  <li>
    <p>2 female-to-female jumper wires</p>
  </li>
  <li>
    <p>7 female-to-male jumper wires</p>
  </li>
  <li>
    <p>2 Leds</p>
  </li>
  <li>
    <p>3.3V power source (for example 2 AA batteries)</p>
  </li>
</ul>

<h2 id="wiring-schemes">Wiring schemes</h2>

<h3 id="programmingflashing-schema">Programming/flashing schema</h3>

<table>
  <thead>
    <tr>
      <th>ESP8266 Pin</th>
      <th>USB-TTL Pin</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>ESP8266 VCC</td>
      <td>USB-TTL VCC +3.3V</td>
    </tr>
    <tr>
      <td>ESP8266 CH_PD</td>
      <td>USB-TTL VCC +3.3V</td>
    </tr>
    <tr>
      <td>ESP8266 GND (-)</td>
      <td>USB-TTL GND</td>
    </tr>
    <tr>
      <td>ESP8266 GPIO 0</td>
      <td>USB-TTL GND</td>
    </tr>
    <tr>
      <td>ESP8266 RX</td>
      <td>USB-TTL TX</td>
    </tr>
    <tr>
      <td>ESP8266 TX</td>
      <td>USB-TTL RX</td>
    </tr>
  </tbody>
</table>

<table>
  <thead>
    <tr>
      <th>LED 1 Pin</th>
      <th>USB-TTL Pin</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>cathode</td>
      <td>USB-TTL GND</td>
    </tr>
  </tbody>
</table>

<table>
  <thead>
    <tr>
      <th>LED 1 Pin</th>
      <th>ESP8266 Pin</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>anode</td>
      <td>ESP8266 GPIO 2</td>
    </tr>
  </tbody>
</table>

<p>The following picture summarizes the connections for this project in programming/debug mode:</p>

<p><img src="/images/samples/esp8266/gpio/schema-flash.png" alt="image" /></p>

<h3 id="final-schema-battery-powered">Final schema (Battery Powered)</h3>

<table>
  <thead>
    <tr>
      <th>ESP8266 Pin</th>
      <th>3.3V power source</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>ESP8266 VCC</td>
      <td>VCC+</td>
    </tr>
    <tr>
      <td>ESP8266 CH_PD</td>
      <td>VCC+</td>
    </tr>
    <tr>
      <td>ESP8266 GND (-)</td>
      <td>VCC-</td>
    </tr>
  </tbody>
</table>

<table>
  <thead>
    <tr>
      <th>LED 1 Pin</th>
      <th>ESP8266 Pin</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>anode</td>
      <td>ESP8266 GPIO 2</td>
    </tr>
  </tbody>
</table>

<table>
  <thead>
    <tr>
      <th>LED 1 Pin</th>
      <th>3.3V power source</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>cathode</td>
      <td>VCC-</td>
    </tr>
  </tbody>
</table>

<table>
  <thead>
    <tr>
      <th>LED 2 Pin</th>
      <th>ESP8266 Pin</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>anode</td>
      <td>ESP8266 GPIO 0</td>
    </tr>
  </tbody>
</table>

<table>
  <thead>
    <tr>
      <th>LED 2 Pin</th>
      <th>3.3V power source</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>cathode</td>
      <td>VCC-</td>
    </tr>
  </tbody>
</table>

<p>The final picture:</p>

<p><img src="/images/samples/esp8266/gpio/schema.png" alt="image" /></p>

<h2 id="thingsboard-configuration">Thingsboard configuration</h2>

<p><strong>Note</strong> Thingsboard configuration steps are necessary only in case of <strong>local Thingsboard installation</strong>.
If you are using <a href="https://demo.thingsboard.io/"><strong>Live Demo</strong></a> instance all entities are pre-configured for your demo account.
However, we recommend to review this steps because you will still need to get device access token to send requests to Thingsboard.</p>

<h3 id="provision-your-device">Provision your device</h3>

<p>This step contains instructions that are necessary to connect your device to Thingsboard.</p>

<p>Open Thingsboard Web UI (http://localhost:8080) in browser and login as tenant administrator</p>

<ul>
  <li>login: tenant@thingsboard.org</li>
  <li>password: tenant</li>
</ul>

<p>Goto “Devices” section. Click “+” button and create device with name “ESP8266 Demo Device”.</p>

<p><img src="/images/samples/esp8266/temperature/device.png" alt="image" /></p>

<p>Once device created, open its details and click “Manage credentials”.
Copy auto-generated access token from the “Access token” field. Please save this device token. It will be referred to later as <strong>$ACCESS_TOKEN</strong>.</p>

<p><img src="/images/samples/esp8266/temperature/credentials.png" alt="image" /></p>

<p>Click “Copy Device ID” in device details to copy your device id to clipboard.
Paste your device id to some place, this value will be used in further steps.</p>

<h3 id="provision-your-dashboard">Provision your dashboard</h3>

<p>Download the dashboard file using this <a href="/docs/samples/esp8266/resources/esp8266_gpio_dashboard_v2.json"><strong>link</strong></a>. 
Use import/export <a href="/docs/user-guide/ui/dashboards/#dashboard-importexport"><strong>instructions</strong></a> to import the dashboard to your Thingsboard instance.</p>

<h2 id="programming-the-esp8266">Programming the ESP8266</h2>

<h3 id="step-1-esp8266-and-arduino-ide-setup">Step 1. ESP8266 and Arduino IDE setup.</h3>

<p>In order to start programming ESP8266 device you will need Arduino IDE installed and all related software.</p>

<p>Download and install <a href="https://www.arduino.cc/en/Main/Software">Arduino IDE</a>.</p>

<p>After starting arduino, open from the ‘file’ menu the preferences.</p>

<p><img src="/images/samples/esp8266/temperature/arduino-preferences.png" alt="image" /></p>

<p>Fill in the “Additional board managers URL” this url:  http://arduino.esp8266.com/stable/package_esp8266com_index.json</p>

<p>Close the screen by the OK button.</p>

<p>Now we can add the board ESP8266 using the board manager.</p>

<p>Click in the menu tools the menu option Board: “<em>Most likely Arduino UNO</em>”. 
There  you will find the first option  “Board Manager”.</p>

<p>Type in the search bar the 3 letters ESP. Locate and click on “<em>esp8266 by ESP8266 Community</em>”. 
Click on install and wait for a minute to download the board.</p>

<p><img src="/images/samples/esp8266/temperature/arduino-board-manager.png" alt="image" /></p>

<p><strong>Note</strong> that this tutorial was tested with the “<em>esp8266 by ESP8266 Community</em>” version 2.3.0.</p>

<p>In the menu Tools “Board “<em>Most likely Arduino UNO</em>” three new boards are added.</p>

<p>Select “Generic ESP8266 Module”.</p>

<p>Prepare your hardware according to the <a href="#programmingflashing-schema">Programming/flashing schema</a>.
Connect USB-TTL adapter with PC.</p>

<p>Select in the menu Tools, port the corresponding port of the USB-TTL adapter.
Open the serial monitor (by pressing CTRL-Shift-M or from the menu Tools).
Set the key emulation to “Both NL &amp; CR” and the speed to 115200 baud. This can be set in the bottom of terminal screen.</p>

<h3 id="step-2-install-arduino-libraries">Step 2. Install Arduino libraries.</h3>

<p>Open Arduino IDE and go to <strong>Sketch -&gt; Include Library -&gt; Manage Libraries</strong>. 
Find and install the following libraries:</p>

<ul>
  <li><a href="http://pubsubclient.knolleary.net/">PubSubClient by Nick O’Leary</a>.</li>
  <li><a href="https://github.com/bblanchon/ArduinoJson">ArduinoJson by Benoit Blanchon</a></li>
</ul>

<p><strong>Note</strong> that this tutorial was tested with the following versions of the libraries:</p>

<ul>
  <li>PubSubClient 2.6</li>
  <li>ArduinoJson 5.8.0</li>
</ul>

<h3 id="step-3-prepare-and-upload-sketch">Step 3. Prepare and upload sketch.</h3>

<p>Download and open <strong>esp8266-gpio-control.ino</strong> sketch.</p>

<p><strong>Note</strong> You need to edit following constants and variables in the sketch:</p>

<ul>
  <li>WIFI_AP - name of your access point</li>
  <li>WIFI_PASSWORD - access point password</li>
  <li>TOKEN - the <strong>$ACCESS_TOKEN</strong> from Thingsboard configuration step.</li>
  <li>thingsboardServer - Thingsboard HOST/IP address that is accessable within your wifi network. Specify “demo.thingsboard.io” if you are using <a href="https://demo.thingsboard.io/">live demo</a> server.</li>
</ul>

<script>
  jqueryUiDefer(initTabs);
  function initTabs() {
    $(function(){$("#arduino-sketch").tabs();});
  }
</script>

<div id="arduino-sketch">
  <ul>
    <li><a href="#esp8266-gpio-control">esp8266-gpio-control.ino</a></li>
  </ul>
  <div id="esp8266-gpio-control">
    <table class="includecode"><thead><tr><th><a href="https://raw.githubusercontent.com/thingsboard/thingsboard.github.io/master/docs/samples/esp8266/resources/esp8266-gpio-control.ino" download="resources/esp8266-gpio-control.ino"><code>resources/esp8266-gpio-control.ino</code></a><img src="/images/copycode.svg" style="max-height:24px" onclick="copyCode('resources/esp8266-gpio-control.ino')" title="Copy resources/esp8266-gpio-control.ino to clipboard" /></th></tr></thead>
<tr><td>
<div id="resources/esp8266-gpio-control.ino" class="language-c highlighter-rouge"><pre class="highlight"><code><span class="cp">#include &lt;ArduinoJson.h&gt;
#include &lt;PubSubClient.h&gt;
#include &lt;ESP8266WiFi.h&gt;
</span>
<span class="cp">#define WIFI_AP "YOUR_WIFI_AP"
#define WIFI_PASSWORD "YOUR_WIFI_PASSWORD"
</span>
<span class="cp">#define TOKEN "ESP8266_DEMO_TOKEN"
</span>
<span class="cp">#define GPIO0 0
#define GPIO2 2
</span>
<span class="cp">#define GPIO0_PIN 3
#define GPIO2_PIN 5
</span>
<span class="kt">char</span> <span class="n">thingsboardServer</span><span class="p">[]</span> <span class="o">=</span> <span class="s">"demo.thingsboard.io"</span><span class="p">;</span>

<span class="n">WiFiClient</span> <span class="n">wifiClient</span><span class="p">;</span>

<span class="n">PubSubClient</span> <span class="n">client</span><span class="p">(</span><span class="n">wifiClient</span><span class="p">);</span>

<span class="kt">int</span> <span class="n">status</span> <span class="o">=</span> <span class="n">WL_IDLE_STATUS</span><span class="p">;</span>

<span class="c1">// We assume that all GPIOs are LOW
</span><span class="n">boolean</span> <span class="n">gpioState</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span><span class="nb">false</span><span class="p">,</span> <span class="nb">false</span><span class="p">};</span>

<span class="kt">void</span> <span class="nf">setup</span><span class="p">()</span> <span class="p">{</span>
  <span class="n">Serial</span><span class="p">.</span><span class="n">begin</span><span class="p">(</span><span class="mi">115200</span><span class="p">);</span>
  <span class="c1">// Set output mode for all GPIO pins
</span>  <span class="n">pinMode</span><span class="p">(</span><span class="n">GPIO0</span><span class="p">,</span> <span class="n">OUTPUT</span><span class="p">);</span>
  <span class="n">pinMode</span><span class="p">(</span><span class="n">GPIO2</span><span class="p">,</span> <span class="n">OUTPUT</span><span class="p">);</span>
  <span class="n">delay</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
  <span class="n">InitWiFi</span><span class="p">();</span>
  <span class="n">client</span><span class="p">.</span><span class="n">setServer</span><span class="p">(</span> <span class="n">thingsboardServer</span><span class="p">,</span> <span class="mi">1883</span> <span class="p">);</span>
  <span class="n">client</span><span class="p">.</span><span class="n">setCallback</span><span class="p">(</span><span class="n">on_message</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">loop</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="n">client</span><span class="p">.</span><span class="n">connected</span><span class="p">()</span> <span class="p">)</span> <span class="p">{</span>
    <span class="n">reconnect</span><span class="p">();</span>
  <span class="p">}</span>

  <span class="n">client</span><span class="p">.</span><span class="n">loop</span><span class="p">();</span>
<span class="p">}</span>

<span class="c1">// The callback for when a PUBLISH message is received from the server.
</span><span class="kt">void</span> <span class="nf">on_message</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">topic</span><span class="p">,</span> <span class="n">byte</span><span class="o">*</span> <span class="n">payload</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">length</span><span class="p">)</span> <span class="p">{</span>

  <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"On message"</span><span class="p">);</span>

  <span class="kt">char</span> <span class="n">json</span><span class="p">[</span><span class="n">length</span> <span class="o">+</span> <span class="mi">1</span><span class="p">];</span>
  <span class="n">strncpy</span> <span class="p">(</span><span class="n">json</span><span class="p">,</span> <span class="p">(</span><span class="kt">char</span><span class="o">*</span><span class="p">)</span><span class="n">payload</span><span class="p">,</span> <span class="n">length</span><span class="p">);</span>
  <span class="n">json</span><span class="p">[</span><span class="n">length</span><span class="p">]</span> <span class="o">=</span> <span class="sc">'\0'</span><span class="p">;</span>

  <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">"Topic: "</span><span class="p">);</span>
  <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="n">topic</span><span class="p">);</span>
  <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">"Message: "</span><span class="p">);</span>
  <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="n">json</span><span class="p">);</span>

  <span class="c1">// Decode JSON request
</span>  <span class="n">StaticJsonBuffer</span><span class="o">&lt;</span><span class="mi">200</span><span class="o">&gt;</span> <span class="n">jsonBuffer</span><span class="p">;</span>
  <span class="n">JsonObject</span><span class="o">&amp;</span> <span class="n">data</span> <span class="o">=</span> <span class="n">jsonBuffer</span><span class="p">.</span><span class="n">parseObject</span><span class="p">((</span><span class="kt">char</span><span class="o">*</span><span class="p">)</span><span class="n">json</span><span class="p">);</span>

  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">data</span><span class="p">.</span><span class="n">success</span><span class="p">())</span>
  <span class="p">{</span>
    <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"parseObject() failed"</span><span class="p">);</span>
    <span class="k">return</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="c1">// Check request method
</span>  <span class="n">String</span> <span class="n">methodName</span> <span class="o">=</span> <span class="n">String</span><span class="p">((</span><span class="k">const</span> <span class="kt">char</span><span class="o">*</span><span class="p">)</span><span class="n">data</span><span class="p">[</span><span class="s">"method"</span><span class="p">]);</span>

  <span class="k">if</span> <span class="p">(</span><span class="n">methodName</span><span class="p">.</span><span class="n">equals</span><span class="p">(</span><span class="s">"getGpioStatus"</span><span class="p">))</span> <span class="p">{</span>
    <span class="c1">// Reply with GPIO status
</span>    <span class="n">String</span> <span class="n">responseTopic</span> <span class="o">=</span> <span class="n">String</span><span class="p">(</span><span class="n">topic</span><span class="p">);</span>
    <span class="n">responseTopic</span><span class="p">.</span><span class="n">replace</span><span class="p">(</span><span class="s">"request"</span><span class="p">,</span> <span class="s">"response"</span><span class="p">);</span>
    <span class="n">client</span><span class="p">.</span><span class="n">publish</span><span class="p">(</span><span class="n">responseTopic</span><span class="p">.</span><span class="n">c_str</span><span class="p">(),</span> <span class="n">get_gpio_status</span><span class="p">().</span><span class="n">c_str</span><span class="p">());</span>
  <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">methodName</span><span class="p">.</span><span class="n">equals</span><span class="p">(</span><span class="s">"setGpioStatus"</span><span class="p">))</span> <span class="p">{</span>
    <span class="c1">// Update GPIO status and reply
</span>    <span class="n">set_gpio_status</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s">"params"</span><span class="p">][</span><span class="s">"pin"</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s">"params"</span><span class="p">][</span><span class="s">"enabled"</span><span class="p">]);</span>
    <span class="n">String</span> <span class="n">responseTopic</span> <span class="o">=</span> <span class="n">String</span><span class="p">(</span><span class="n">topic</span><span class="p">);</span>
    <span class="n">responseTopic</span><span class="p">.</span><span class="n">replace</span><span class="p">(</span><span class="s">"request"</span><span class="p">,</span> <span class="s">"response"</span><span class="p">);</span>
    <span class="n">client</span><span class="p">.</span><span class="n">publish</span><span class="p">(</span><span class="n">responseTopic</span><span class="p">.</span><span class="n">c_str</span><span class="p">(),</span> <span class="n">get_gpio_status</span><span class="p">().</span><span class="n">c_str</span><span class="p">());</span>
    <span class="n">client</span><span class="p">.</span><span class="n">publish</span><span class="p">(</span><span class="s">"v1/devices/me/attributes"</span><span class="p">,</span> <span class="n">get_gpio_status</span><span class="p">().</span><span class="n">c_str</span><span class="p">());</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="n">String</span> <span class="nf">get_gpio_status</span><span class="p">()</span> <span class="p">{</span>
  <span class="c1">// Prepare gpios JSON payload string
</span>  <span class="n">StaticJsonBuffer</span><span class="o">&lt;</span><span class="mi">200</span><span class="o">&gt;</span> <span class="n">jsonBuffer</span><span class="p">;</span>
  <span class="n">JsonObject</span><span class="o">&amp;</span> <span class="n">data</span> <span class="o">=</span> <span class="n">jsonBuffer</span><span class="p">.</span><span class="n">createObject</span><span class="p">();</span>
  <span class="n">data</span><span class="p">[</span><span class="n">String</span><span class="p">(</span><span class="n">GPIO0_PIN</span><span class="p">)]</span> <span class="o">=</span> <span class="n">gpioState</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">?</span> <span class="nb">true</span> <span class="o">:</span> <span class="nb">false</span><span class="p">;</span>
  <span class="n">data</span><span class="p">[</span><span class="n">String</span><span class="p">(</span><span class="n">GPIO2_PIN</span><span class="p">)]</span> <span class="o">=</span> <span class="n">gpioState</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">?</span> <span class="nb">true</span> <span class="o">:</span> <span class="nb">false</span><span class="p">;</span>
  <span class="kt">char</span> <span class="n">payload</span><span class="p">[</span><span class="mi">256</span><span class="p">];</span>
  <span class="n">data</span><span class="p">.</span><span class="n">printTo</span><span class="p">(</span><span class="n">payload</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">payload</span><span class="p">));</span>
  <span class="n">String</span> <span class="n">strPayload</span> <span class="o">=</span> <span class="n">String</span><span class="p">(</span><span class="n">payload</span><span class="p">);</span>
  <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">"Get gpio status: "</span><span class="p">);</span>
  <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="n">strPayload</span><span class="p">);</span>
  <span class="k">return</span> <span class="n">strPayload</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">set_gpio_status</span><span class="p">(</span><span class="kt">int</span> <span class="n">pin</span><span class="p">,</span> <span class="n">boolean</span> <span class="n">enabled</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">pin</span> <span class="o">==</span> <span class="n">GPIO0_PIN</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Output GPIOs state
</span>    <span class="n">digitalWrite</span><span class="p">(</span><span class="n">GPIO0</span><span class="p">,</span> <span class="n">enabled</span> <span class="o">?</span> <span class="n">HIGH</span> <span class="o">:</span> <span class="n">LOW</span><span class="p">);</span>
    <span class="c1">// Update GPIOs state
</span>    <span class="n">gpioState</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">enabled</span><span class="p">;</span>
  <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">pin</span> <span class="o">==</span> <span class="n">GPIO2_PIN</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Output GPIOs state
</span>    <span class="n">digitalWrite</span><span class="p">(</span><span class="n">GPIO2</span><span class="p">,</span> <span class="n">enabled</span> <span class="o">?</span> <span class="n">HIGH</span> <span class="o">:</span> <span class="n">LOW</span><span class="p">);</span>
    <span class="c1">// Update GPIOs state
</span>    <span class="n">gpioState</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">enabled</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">InitWiFi</span><span class="p">()</span> <span class="p">{</span>
  <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"Connecting to AP ..."</span><span class="p">);</span>
  <span class="c1">// attempt to connect to WiFi network
</span>
  <span class="n">WiFi</span><span class="p">.</span><span class="n">begin</span><span class="p">(</span><span class="n">WIFI_AP</span><span class="p">,</span> <span class="n">WIFI_PASSWORD</span><span class="p">);</span>
  <span class="k">while</span> <span class="p">(</span><span class="n">WiFi</span><span class="p">.</span><span class="n">status</span><span class="p">()</span> <span class="o">!=</span> <span class="n">WL_CONNECTED</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">delay</span><span class="p">(</span><span class="mi">500</span><span class="p">);</span>
    <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">"."</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"Connected to AP"</span><span class="p">);</span>
<span class="p">}</span>


<span class="kt">void</span> <span class="nf">reconnect</span><span class="p">()</span> <span class="p">{</span>
  <span class="c1">// Loop until we're reconnected
</span>  <span class="k">while</span> <span class="p">(</span><span class="o">!</span><span class="n">client</span><span class="p">.</span><span class="n">connected</span><span class="p">())</span> <span class="p">{</span>
    <span class="n">status</span> <span class="o">=</span> <span class="n">WiFi</span><span class="p">.</span><span class="n">status</span><span class="p">();</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">status</span> <span class="o">!=</span> <span class="n">WL_CONNECTED</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">WiFi</span><span class="p">.</span><span class="n">begin</span><span class="p">(</span><span class="n">WIFI_AP</span><span class="p">,</span> <span class="n">WIFI_PASSWORD</span><span class="p">);</span>
      <span class="k">while</span> <span class="p">(</span><span class="n">WiFi</span><span class="p">.</span><span class="n">status</span><span class="p">()</span> <span class="o">!=</span> <span class="n">WL_CONNECTED</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">delay</span><span class="p">(</span><span class="mi">500</span><span class="p">);</span>
        <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">"."</span><span class="p">);</span>
      <span class="p">}</span>
      <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"Connected to AP"</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">"Connecting to Thingsboard node ..."</span><span class="p">);</span>
    <span class="c1">// Attempt to connect (clientId, username, password)
</span>    <span class="k">if</span> <span class="p">(</span> <span class="n">client</span><span class="p">.</span><span class="n">connect</span><span class="p">(</span><span class="s">"ESP8266 Device"</span><span class="p">,</span> <span class="n">TOKEN</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
      <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span> <span class="s">"[DONE]"</span> <span class="p">);</span>
      <span class="c1">// Subscribing to receive RPC requests
</span>      <span class="n">client</span><span class="p">.</span><span class="n">subscribe</span><span class="p">(</span><span class="s">"v1/devices/me/rpc/request/+"</span><span class="p">);</span>
      <span class="c1">// Sending current GPIO status
</span>      <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"Sending current GPIO status ..."</span><span class="p">);</span>
      <span class="n">client</span><span class="p">.</span><span class="n">publish</span><span class="p">(</span><span class="s">"v1/devices/me/attributes"</span><span class="p">,</span> <span class="n">get_gpio_status</span><span class="p">().</span><span class="n">c_str</span><span class="p">());</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span> <span class="s">"[FAILED] [ rc = "</span> <span class="p">);</span>
      <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span> <span class="n">client</span><span class="p">.</span><span class="n">state</span><span class="p">()</span> <span class="p">);</span>
      <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span> <span class="s">" : retrying in 5 seconds]"</span> <span class="p">);</span>
      <span class="c1">// Wait 5 seconds before retrying
</span>      <span class="n">delay</span><span class="p">(</span> <span class="mi">5000</span> <span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>
</td></tr></table>
  </div>
</div>

<p>Connect USB-TTL adapter to PC and select the corresponding port in Arduino IDE. Compile and Upload your sketch to device using “Upload” button.</p>

<p>After application will be uploaded and started it will try to connect to Thingsboard node using mqtt client and upload current GPIOs state.</p>

<h2 id="autonomous-operation">Autonomous operation</h2>

<p>When you have uploaded the sketch, you may remove all the wires required for uploading including USB-TTL adapter and connect your ESP8266 and LEDs directly to power source according to the <a href="#final-schema-battery-powered">Final wiring schema</a>.</p>

<h2 id="troubleshooting">Troubleshooting</h2>

<p>In order to perform troubleshooting you should assemble your hardware according to the <a href="#programmingflashing-schema">Programming/flashing schema</a>.
Then connect USB-TTL adapter with PC and select port of the USB-TTL adapter in Arduino IDE. Finally open “Serial Monitor” in order to view debug information produced by serial output.</p>

<h2 id="data-visualization">Data visualization</h2>

<p>Finally, open Thingsboard Web UI. You can access this dashboard by logging in as a tenant administrator.</p>

<p>In case of local installation:</p>

<ul>
  <li>login: tenant@thingsboard.org</li>
  <li>password: tenant</li>
</ul>

<p>In case of live-demo server:</p>

<ul>
  <li>login: your live-demo username (email)</li>
  <li>password: your live-demo password</li>
</ul>

<p>See <strong><a href="/docs/user-guide/live-demo/">live-demo</a></strong> page for more details how to get your account.</p>

<p>Once logged in, open <strong>Dashboards-&gt;ESP8266 GPIO Demo Dashboard</strong> page. You should observe demo dashboard with GPIO control and status panel for your device. 
Now you can switch status of GPIOs using control panel. As a result you will see LEDs status change on device and on the status panel.</p>

<p>Below is the screenshot of the “ESP8266 GPIO Demo Dashboard”.</p>

<p><img src="/images/samples/esp8266/gpio/dashboard.png" alt="image" /></p>

<h2 id="next-steps">Next steps</h2>

<p>Browse other <a href="/docs/samples">samples</a> or explore guides related to main Thingsboard features:</p>

<ul>
  <li><a href="/docs/user-guide/attributes/">Device attributes</a> - how to use device attributes.</li>
  <li><a href="/docs/user-guide/telemetry/">Telemetry data collection</a> - how to collect telemetry data.</li>
  <li><a href="/docs/user-guide/rpc/">Using RPC capabilities</a> - how to send commands to/from devices.</li>
  <li><a href="/docs/user-guide/rule-engine/">Rule Engine</a> - how to use rule engine to analyze data from devices.</li>
  <li><a href="/docs/user-guide/visualization/">Data Visualization</a> - how to visualize collected data.</li>
</ul>

<h2 id="your-feedback">Your feedback</h2>

<p>Don’t hesitate to star Thingsboard on <strong><a href="https://github.com/thingsboard/thingsboard">github</a></strong> to help us spread the word.
If you have some questions about this sample - post it on the <strong><a href="https://groups.google.com/forum/#!forum/thingsboard">forum</a></strong>.</p>

<div id="share"></div>
<script>
    jqueryDefer(initSocials);
    function initSocials() {
        var scriptsList = [
            {src: 'https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials.css', type: 'css'},
            {src: 'https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials-theme-flat.css', type: 'css'},
            {src: 'https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials.min.js', type: 'script'}
        ];
        loadNextScript(0, scriptsList,
                function() {
                    $("#share").jsSocials({
                        shares: ["email", "twitter", "facebook", "googleplus", "linkedin", "pinterest", "stumbleupon", "whatsapp", "telegram"],
                        showLabel: false,
                        showCount: false
                    });
                }
        );
    }
</script>


  </div>
</section>

<footer>
	<main class="light-text">
		<nav>
			<a href="/docs/getting-started-guides/helloworld/">Get Started</a>
			<a href="/docs/">Documentation</a>
			<a href="/iot-use-cases/">Use cases</a>
			<a href="https://blog.thingsboard.io/">Blog</a>
			<a href="/docs/services/">Services</a>
			<a href="/docs/contact-us/">Contact us</a>
		</nav>
		<div class="newsletterSubsContainer">
			<form id="newsletter-form" method="post" onsubmit="return validateNewsletterForm(this)">
				<fieldset>
					<div class="newsletterInputs">
						<p class="subsTitle">Sign up for Thingsboard IoT newsletter</p>
						<input id="subsEmail" placeholder="Email" class="text-input" name="email" type="text" size="20" maxlength="80">
						<input type="hidden" name="_next" value="/docs/newsletter-thanks/" />
						<input type="text" name="_gotcha" style="display:none" />
						<input class="button" value="Submit" type="submit">
					</div>
				</fieldset>
			</form>
		</div>
		<div class="center">
			<div class="social">
				<div>
					<a href="https://twitter.com/thingsboard" class="twitter"><span>twitter</span></a>
					<a href="https://github.com/thingsboard/thingsboard" class="github"><span>Github</span></a>
					<a href="https://gitter.im/thingsboard/chat" class="gitter"><span>Gitter</span></a>
					<a href="http://stackoverflow.com/questions/tagged/thingsboard" class="stack-overflow"><span>Stack Overflow</span></a>
				</div>
				<div>
					<a href="https://groups.google.com/forum/#!forum/thingsboard" class="mailing-list"><span>Mailing List</span></a>
					<a href="https://www.youtube.com/channel/UCDb9fsV-YR4JmnipAMGsVAQ" class="youtube"><span>YouTube Channel</span></a>
					<a href="https://www.facebook.com/thingsboard" class="facebook"><span>Facebook Page</span></a>
				</div>
			</div>
		</div>
		<div id="miceType" class="center">&copy; 2017 The Thingsboard Authors</div>
	</main>

	<script type="text/javascript">

		function validateNewsletterForm(form) {
			var email = $('input[name=email]', form).val();

			if (!validateValue('Email Address', email)) {
				return false;
			}

			var emailExp = /^[a-zA-Z0-9._%-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/;
			if(email.match(emailExp)==null) {
				window.alert("Entered Email Address is not valid.");
				return false;
			}
			return true;
		}

		function validateValue(name, val) {
			if (isEmpty(val)) {
				window.alert("Please fill '" + name + "' field.");
				return false;
			}
			return true;
		}

		function isEmpty(val) {
			return val === undefined || val.trim().length == 0;
		}

	</script>

	<script type="text/javascript">

		var newsletterform =  document.getElementById('newsletter-form');
		newsletterform.setAttribute('action', 'https://formspree.io/' + 'newsletter' + '@' + 'thingsboard' + '.' + 'io');

	</script>

</footer>



<button class="flyout-button" onclick="tb.toggleToc()"></button>


<style>
  .cse .gsc-control-cse, .gsc-control-cse {
    padding: 0;
  }
  .gsc-control-cse table, .gsc-control-cse-en table {
    margin:0px !important;
  }
  .gsc-above-wrapper-area {
    border-bottom: 0;
  }
</style>
</body>
</html>
