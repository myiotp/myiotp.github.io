

<!Doctype html>
<html id="docs" class="Thingsboard Documentation">



<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	
	<!-- Begin Jekyll SEO tag v2.0.0 -->
<title>Using RPC capabilities - Thingsboard</title>
<meta property="og:title" content="Using RPC capabilities" />
<meta name="description" content="Remote control of IoT devices from the Thingsboard IoT cloud using RPC feature" />
<meta property="og:description" content="Remote control of IoT devices from the Thingsboard IoT cloud using RPC feature" />
<link rel="canonical" href="http://localhost:4000/docs/user-guide/rpc/" />
<meta property="og:url" content="http://localhost:4000/docs/user-guide/rpc/" />
<meta property="og:site_name" content="Thingsboard" />
<meta property="og:image" content="http://localhost:4000/images/thingsboard_logo.png" />
<meta name="twitter:image" content="http://localhost:4000/images/thingsboard_logo.png" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:site" content="@thingsboard" />
<meta name="twitter:creator" content="@thingsboard" />
<script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "WebPage",
    "headline": "Using RPC capabilities",
    "image": "http://localhost:4000/images/thingsboard_logo.png",
    "description": "Remote control of IoT devices from the Thingsboard IoT cloud using RPC feature",
    "logo": "http://localhost:4000/images/thingsboard_logo.png",
    "url": "http://localhost:4000/docs/user-guide/rpc/"
  }
</script>
<!-- End Jekyll SEO tag -->
	
	
	<link rel="shortcut icon" type="image/png" href="/images/favicon.png">

	<link rel="stylesheet" href="/css/styles.css">
	<script type="text/javascript">
		/*! loadCSS. [c]2017 Filament Group, Inc. MIT License */
		!function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this);
		/*! onloadCSS. (onload callback for loadCSS) [c]2017 Filament Group, Inc. MIT License */
		function onloadCSS(a,b){function c(){!d&&b&&(d=!0,b.call(a))}var d;a.addEventListener&&a.addEventListener("load",c),a.attachEvent&&a.attachEvent("onload",c),"isApplicationInstalled"in navigator&&"onloadcssdefined"in a&&a.onloadcssdefined(c)}
	</script>
	<script type="text/javascript">

		function jqueryDefer(method) {
			if (window.jQuery) {
				method();
			} else {
				setTimeout(function() {
					jqueryDefer(method)
				}, 50);
			}
		}

		function jqueryUiDefer(method) {
			if (window.jQuery && window.jQuery.ui) {
				method();
			} else {
				setTimeout(function() {
					jqueryUiDefer(method)
				}, 50);
			}
		}

		function loadScript(src, callback)
		{
			var s, r, t;
			r = false;
			s = document.createElement('script');
			s.type = 'text/javascript';
			s.src = src;
			s.onload = s.onreadystatechange = function() {
				if ( !r && (!this.readyState || this.readyState == 'complete') )
				{
					r = true;
					if (callback) {
						callback();
					}
				}
			};
			t = document.getElementsByTagName('script')[0];
			t.parentNode.insertBefore(s, t);
		}

		function loadCssAsync(src, callback) {
			var stylesheet = loadCSS( src );
			if (callback) {
				onloadCSS(stylesheet, callback);
			}
		}

		function loadNextScript(index, scriptsList, completeCallback) {
			if (index < scriptsList.length) {
				var script = scriptsList[index];
				if (script.type === 'script') {
					loadScript(script.src, function() {
						index++;
						loadNextScript(index, scriptsList, completeCallback);
					});
				} else if (script.type === 'css') {
					loadCssAsync(script.src, function() {
						index++;
						loadNextScript(index, scriptsList, completeCallback);
					});
				}
			} else if (completeCallback) {
				completeCallback();
			}
		}

		var initialScriptsList = [
			{src: '/js/jquery-2.2.0.min.js', type: 'script'},
			{src: '/css/jquery-ui.min.css', type: 'css'},
			{src: '/js/jquery-ui.min.js', type: 'script'},
			{src: '/js/script.js', type: 'script'},
			{src: '/css/sweetalert.css', type: 'css'},
			{src: '/js/sweetalert.min.js', type: 'script'}
		];

		loadNextScript(0, initialScriptsList);

	</script>
	<script type="text/javascript">
		function _gaLt(event) {
			/* If GA is blocked or not loaded, or not main|middle|touch click then don't track */
			if (!ga.hasOwnProperty("loaded") || ga.loaded != true || (event.which != 1 && event.which != 2)) {
				return;
			}
			var el = event.srcElement || event.target;

			while (el && (typeof el.tagName == 'undefined' || el.tagName.toLowerCase() != 'a' || !el.href)) {
				el = el.parentNode;
			}
			if (el && el.href) {
				var link = el.href;
				if ((link.indexOf(location.host) == -1 || link.indexOf('.' + location.host) > 0) && !link.match(/^javascript\:/i)) {
					var target = (el.target && !el.target.match(/^_(self|parent|top)$/i)) ? el.target : false;
					if (event.ctrlKey || event.shiftKey || event.metaKey || event.which == 2) {
						target = "_blank";
					}

					var hbrun = false; // tracker has not yet run
					var hitBack = function() {
						if (hbrun) return;
						hbrun = true;
						window.location.href = link;
					};

					if (target) {
						ga(
								"send", "event", "Outgoing Links", link,
								document.location.pathname + document.location.search
						);
					} else {
						event.preventDefault ? event.preventDefault() : event.returnValue = !1;
						ga(
								"send", "event", "Outgoing Links", link,
								document.location.pathname + document.location.search, {
									"hitCallback": hitBack
								}
						);

						setTimeout(hitBack, 1000);
					}
				}
			}
		}

		var _w = window;
		var _gaLtEvt = ("ontouchstart" in _w) ? "click" : "mousedown";
		_w.addEventListener ? _w.addEventListener("load", function() {document.body.addEventListener(_gaLtEvt, _gaLt, !1)}, !1)
				: _w.attachEvent && _w.attachEvent("onload", function() {document.body.attachEvent("on" + _gaLtEvt, _gaLt)});
	</script>
</head>
<body>
<div id="cellophane" onclick="tb.toggleMenu()"></div>
<header>
	<a href="#" class="logo"></a>
	<div class="nav-buttons" data-auto-burger="primary">
		<a href="#" class="button" id="viewDocs" data-auto-burger-exclude>&nbsp;&nbsp;主要功能&nbsp;&nbsp;</a>
		<a href="#" class="button" id="useCases" data-auto-burger-exclude>&nbsp;&nbsp;查看文档&nbsp;&nbsp;</a>
		<a href="#" class="button" id="useCases" data-auto-burger-exclude>&nbsp;&nbsp;案例分析&nbsp;&nbsp;</a>
		<a href="#" class="button" id="gettingStarted" data-auto-burger-exclude>&nbsp;&nbsp;开始使用&nbsp;&nbsp;</a>
		<button id="hamburger" onclick="tb.toggleMenu()" data-auto-burger-exclude><div></div></button>
	</div>

	<nav id="mainNav">
		<main id="headNav" data-auto-burger="primary">
			<div class="nav-box">
				<h3><a href="#">开始使用<a></h3>
			</div>
			<div class="nav-box">
				<h3><a href="#">查看文档</a></h3>
			</div>
			<div class="nav-box">
				<h3><a href="#">案例分析</a></h3>
			</div>
			<div class="nav-box">
				<h3><a href="http://osswangxining.github.io/">Blog</a></h3>
			</div>
			<div class="nav-box">
				<h3><a href="#">服务支持</a></h3>
			</div>
			<div class="nav-box">
				<h3><a href="#">联系我们</a></h3>
			</div>
		</main>

	</nav>
</header>


<!--  HERO  -->
<section id="hero" class="light-text">
  <h1>Thingsboard Documentation</h1>
  <h5>Documentation for using Thingsboard IoT Platform.</h5>
  <div id="vendorStrip" class="light-text">
    <div id="docsList">
        <ul>
          <li><a href="/docs/" class="YAH">DOCS HOME</a></li>
          <li><a href="/docs/api/" >API</a></li>
          <li><a href="/docs/iot-gateway/" >IOT GATEWAY</a></li>
          <li><a href="/docs/reference/" >REFERENCE</a></li>
          <li><a href="/docs/samples/" >SAMPLES</a></li>
          <li><a href="/iot-use-cases/" >USE CASES</a></li>
          <li><a href="/docs/iot-video-tutorials/" >VIDEO TUTORIALS</a></li>
          <li><a href="/docs/faq/" >FAQ</a></li>
          <li><a href="/docs/services/" >SERVICES</a></li>
          <li><a href="/docs/contact-us/" >CONTACT US</a></li>
        </ul>
    </div>
    <div id="searchBox">
      <input type="text" id="search" placeholder="Search" onkeydown="if (event.keyCode==13) window.location.replace('/docs/search/?q=' + this.value)">
    </div>
  </div>
</section>





<section id="encyclopedia">
  
  <div id="docsToc" >
        <div class="pi-accordion">
        
    <a class="item" data-title="Thingsboard Documentation" href="/docs/"></a>
    <a class="item" data-title="What is Thingsboard?" href="/docs/getting-started-guides/what-is-thingsboard/"></a>
    <a class="item" data-title="Getting Started" href="/docs/getting-started-guides/helloworld/"></a>
<div class="item" data-title="Installation">
  <div class="container">
    <a class="item" data-title="Installation options" href="/docs/user-guide/install/installation-options/"></a>
    <a class="item" data-title="Installing Thingsboard on Windows" href="/docs/user-guide/install/windows/"></a>
    <a class="item" data-title="Installing Thingsboard on Linux (Ubuntu & CentOS)" href="/docs/user-guide/install/linux/"></a>
    <a class="item" data-title="Installing Thingsboard on Raspberry Pi 3" href="/docs/user-guide/install/rpi/"></a>
    <a class="item" data-title="Installing Thingsboard using Docker (Linux or Mac OS)" href="/docs/user-guide/install/docker/"></a>
    <a class="item" data-title="Installing Thingsboard using Docker (Windows)" href="/docs/user-guide/install/docker-windows/"></a>
    <a class="item" data-title="Installing Thingsboard on AWS EC2" href="/docs/user-guide/install/aws/"></a>
    <a class="item" data-title="Building from sources" href="/docs/user-guide/install/building-from-source/"></a>
    <a class="item" data-title="Upgrade instructions" href="/docs/user-guide/install/upgrade-instructions/"></a>
    <a class="item" data-title="Configuration" href="/docs/user-guide/install/config/"></a>
    <a class="item" data-title="Cluster setup" href="/docs/user-guide/install/cluster-setup/"></a>
  </div>
</div>
<div class="item" data-title="Features">
  <div class="container">
    <a class="item" data-title="Working with device attributes" href="/docs/user-guide/attributes/"></a>
    <a class="item" data-title="Working with telemetry data" href="/docs/user-guide/telemetry/"></a>
    <a class="item" data-title="Using RPC capabilities" href="/docs/user-guide/rpc/"></a>
    <a class="item" data-title="Rule engine" href="/docs/user-guide/rule-engine/"></a>
    <a class="item" data-title="Data visualization" href="/docs/user-guide/visualization/"></a>
  </div>
</div>
<div class="item" data-title="Integrations Cookbook">
  <div class="container">
    <a class="item" data-title="Persist and visualize AWS IoT data" href="/docs/iot-gateway/integration-with-aws-iot/"></a>
    <a class="item" data-title="IoT data analytics using Apache Spark" href="/docs/samples/analytics/spark-integration-with-thingsboard/"></a>
    <a class="item" data-title="SigFox IoT data collection and visualization" href="/docs/iot-gateway/sigfox-iot-data-visualization/"></a>
    <a class="item" data-title="Persist and visualize IBM Watson IoT data" href="/docs/iot-gateway/integration-with-ibm-watson-iot/"></a>
  </div>
</div>
<div class="item" data-title="Security">
  <div class="container">
    <a class="item" data-title="MQTT over SSL" href="/docs/user-guide/mqtt-over-ssl/"></a>
    <a class="item" data-title="Device authentication options" href="/docs/user-guide/device-credentials/"></a>
    <a class="item" data-title="Access Token based authentication" href="/docs/user-guide/access-token/"></a>
    <a class="item" data-title="X.509 Certificate based authentication" href="/docs/user-guide/certificates/"></a>
  </div>
</div>
<div class="item" data-title="Administration UI">
  <div class="container">
    <a class="item" data-title="Tenants" href="/docs/user-guide/ui/tenants/"></a>
    <a class="item" data-title="Customers" href="/docs/user-guide/ui/customers/"></a>
    <a class="item" data-title="Users" href="/docs/user-guide/ui/users/"></a>
    <a class="item" data-title="Devices" href="/docs/user-guide/ui/devices/"></a>
    <a class="item" data-title="Rules" href="/docs/user-guide/ui/rules/"></a>
    <a class="item" data-title="Plugins" href="/docs/user-guide/ui/plugins/"></a>
    <a class="item" data-title="Widgets Library" href="/docs/user-guide/ui/widget-library/"></a>
    <a class="item" data-title="Dashboards" href="/docs/user-guide/ui/dashboards/"></a>
    <a class="item" data-title="Mail Settings" href="/docs/user-guide/ui/mail-settings/"></a>
  </div>
</div>
    <a class="item" data-title="Troubleshooting" href="/docs/user-guide/troubleshooting/"></a>
<div class="item" data-title="Contribution Guide">
  <div class="container">
    <a class="item" data-title="How to contribute" href="/docs/user-guide/contribution/how-to-contribute/"></a>
    <a class="item" data-title="Extensions (Plugins and Actions) development" href="/docs/user-guide/contribution/extensions-development/"></a>
  </div>
</div>
        </div> <!-- /pi-accordion -->
    <button class="push-menu-close-button" onclick="tb.toggleToc()"></button>
  </div> <!-- /docsToc -->
  
  <div id="docsContent" class="">
    <h1>Using RPC capabilities</h1>
    <ul id="markdown-toc">
  <li><a href="#rpc-call-types" id="markdown-toc-rpc-call-types">RPC call types</a></li>
  <li><a href="#device-rpc-api" id="markdown-toc-device-rpc-api">Device RPC API</a></li>
  <li><a href="#server-side-rpc-api" id="markdown-toc-server-side-rpc-api">Server-side RPC API</a></li>
  <li><a href="#rpc-widgets" id="markdown-toc-rpc-widgets">RPC widgets</a></li>
</ul>

<p>Thingsboard allows you to send remote procedure calls (RPC) from server side applications to devices and vise versa. 
Basically, this feature allows you to send commands to devices and receive results of commands execution. 
Similar, you can execute request from the device, apply some calculations or other server-side logic on back-end and push response back to the device.
This guide covers Thingsboard RPC capabilities. After reading this guide, you will get familiar with following topics:</p>

<ul>
  <li>RPC call types</li>
  <li>Basic RPC use-cases</li>
  <li>RPC client-side and server-side APIs</li>
  <li>RPC widgets</li>
</ul>

<h2 id="rpc-call-types">RPC call types</h2>

<p>Thinsboard RPC feature can be divided into two types based on originator: device-originated and server-originated RPC calls.
In order to use more familiar names, we will name device-originated RPC calls as a <strong>client-side</strong> RPC calls 
and server-originated RPC calls as <strong>server-side</strong> RPC calls.</p>

<p style="text-align: center;"><img src="/images/user-guide/client-side-rpc.svg" alt="image" /></p>

<p>Server-side RPC calls can be divided into one-way and two-way:</p>

<ul>
  <li>
    <p>One-way RPC request is sent to the device without delivery confirmation and obviously, does not provide response from device. 
RPC call may fail only if there is no active connection with the target device within configurable timeout period.</p>

    <p style="text-align: center;"><img src="/images/user-guide/one-way-rpc.svg" alt="image" /></p>
  </li>
  <li>
    <p>Two-way RPC request is sent to the device and expects to receive response from the device within certain timeout. 
Server-side request is blocked until the target device will reply to the request.</p>

    <p style="text-align: center;"><img src="/images/user-guide/two-way-rpc.svg" alt="image" /></p>
  </li>
</ul>

<h2 id="device-rpc-api">Device RPC API</h2>

<p>Thingsboard provides convenient API to send and receive RPC commands from applications running on the device. 
This API is specific for each supported network protocol.
You can review API and examples in corresponding reference page:</p>

<ul>
  <li><a href="/docs/reference/mqtt-api/#rpc-api">MQTT RPC API reference</a></li>
  <li><a href="/docs/reference/coap-api/#rpc-api">CoAP RPC API reference</a></li>
  <li><a href="/docs/reference/http-api/#rpc-api">HTTP RPC API reference</a></li>
</ul>

<h2 id="server-side-rpc-api">Server-side RPC API</h2>

<p>Thingsboard provides <strong>System RPC Plugin</strong> that allows you to send RPC calls from server-side applications to the device.
In order to send RPC request you need execute HTTP POST request to the following URL:</p>

<div class="language-shell highlighter-rouge"><pre class="highlight"><code>http<span class="o">(</span>s<span class="o">)</span>://host:port/api/plugins/rpc/<span class="o">{</span>callType<span class="o">}</span>/<span class="o">{</span>deviceId<span class="o">}</span>
</code></pre>
</div>

<p>where</p>

<ul>
  <li><strong>callType</strong> is either <strong>oneway</strong> or <strong>twoway</strong></li>
  <li><strong>deviceId</strong> is your target <a href="/docs/user-guide/ui/devices/#get-device-id">device id</a></li>
</ul>

<p>The request body should be a valid json object with two elements:</p>

<ul>
  <li><strong>method</strong> - method name, json string</li>
  <li><strong>params</strong> - method parameters, json object</li>
</ul>

<p>For example:</p>

<script>
  jqueryUiDefer(initTabs);
  function initTabs() {
    $(function(){$("#mqtt-rpc-from-client").tabs();});
  }
</script>

<div id="mqtt-rpc-from-client">
  <ul>
    <li><a href="#A">set-gpio-request.sh</a></li>
    <li><a href="#B">set-gpio-request.json</a></li>
  </ul>
  <div id="A">
    <table class="includecode"><thead><tr><th><a href="https://raw.githubusercontent.com/thingsboard/thingsboard.github.io/master/docs/user-guide/resources/set-gpio-request.sh" download="resources/set-gpio-request.sh"><code>resources/set-gpio-request.sh</code></a><img src="/images/copycode.svg" style="max-height:24px" onclick="copyCode('resources/set-gpio-request.sh')" title="Copy resources/set-gpio-request.sh to clipboard" /></th></tr></thead>
<tr><td>
<div id="resources/set-gpio-request.sh" class="language-shell highlighter-rouge"><pre class="highlight"><code>curl -v -X POST -d @set-gpio-request.json http://localhost:8080/api/plugins/rpc/twoway/<span class="nv">$DEVICE_ID</span> <span class="se">\</span>
--header <span class="s2">"Content-Type:application/json"</span> <span class="se">\</span>
--header <span class="s2">"X-Authorization: </span><span class="nv">$JWT_TOKEN</span><span class="s2">"</span>
</code></pre>
</div>
</td></tr></table>
  </div>
  <div id="B">
    <table class="includecode"><thead><tr><th><a href="https://raw.githubusercontent.com/thingsboard/thingsboard.github.io/master/docs/user-guide/resources/set-gpio-request.json" download="resources/set-gpio-request.json"><code>resources/set-gpio-request.json</code></a><img src="/images/copycode.svg" style="max-height:24px" onclick="copyCode('resources/set-gpio-request.json')" title="Copy resources/set-gpio-request.json to clipboard" /></th></tr></thead>
<tr><td>
<div id="resources/set-gpio-request.json" class="language-json highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"setGpio"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"params"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"pin"</span><span class="p">:</span><span class="w"> </span><span class="s2">"23"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"value"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>
</td></tr></table>
  </div>
</div>

<p>Please <strong>note</strong> that in order to execute this request, you will need to substitute <strong>$JWT_TOKEN</strong> with a valid JWT token.
This token should belong to either</p>

<ul>
  <li>user with <strong>TENANT_ADMIN</strong> role</li>
  <li>user with <strong>CUSTOMER_USER</strong> role that owns the device identified by <strong>$DEVICE_ID</strong></li>
</ul>

<p>You can use following <a href="/docs/reference/rest-api/#rest-api-auth">guide</a> to get the token.</p>

<h2 id="rpc-widgets">RPC widgets</h2>

<p>See <a href="/docs/user-guide/ui/widget-library/#gpio-widgets">widgets library</a> for more details.</p>

  </div>
</section>

<footer>
	<main class="light-text">
		
		<div id="miceType" class="center">&copy; 2016 - 2017 IoT套件</div>
	</main>

</footer>



<button class="flyout-button" onclick="tb.toggleToc()"></button>


<style>
  .cse .gsc-control-cse, .gsc-control-cse {
    padding: 0;
  }
  .gsc-control-cse table, .gsc-control-cse-en table {
    margin:0px !important;
  }
  .gsc-above-wrapper-area {
    border-bottom: 0;
  }
</style>
</body>
</html>
